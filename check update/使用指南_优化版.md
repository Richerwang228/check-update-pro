# 视频更新检查器 - 优化版使用指南

## 🌟 简介

这是一个现代化的视频更新监控工具，具有以下特点：
- 🚀 **极速检查**: 并发技术，检查速度提升4倍
- 🎨 **现代UI**: 渐变色设计，流畅动画
- ⌨️ **快捷操作**: 丰富的快捷键支持
- 💾 **智能缓存**: 自动缓存图片，节省流量
- 📊 **统计信息**: 实时查看使用统计

## 📦 安装

### 1. 环境要求
```bash
Python 3.8 或更高版本
```

### 2. 安装依赖
```bash
cd "check update"
pip install -r requirements.txt
```

### 3. 运行程序
```bash
python main.py
```

或者双击 `run.bat` (Windows)

## 🎯 核心功能

### 1. 添加UP主
**方法一: 通过界面**
- 点击 `➕ 添加UP主` 按钮
- 输入UP主的主页URL
- 例如: `https://hsex.men/user.htm?author=xxx`

**方法二: 导入书签**
- 点击 `📂 导入书签` 按钮
- 选择浏览器导出的书签HTML文件
- 程序会自动识别相关链接

**方法三: 快捷键**
- 按 `Ctrl+N` 快速打开添加对话框
- 按 `Ctrl+I` 快速打开导入对话框

### 2. 检查更新
**自动检查**
- 程序会根据设置的时间间隔自动检查
- 默认每1小时检查一次
- 可在设置中调整间隔和更新范围

**手动检查**
- 点击 `🔄 立即检查` 按钮
- 或按 `F5` / `Ctrl+R`
- 进度条会显示：
  - 当前进度百分比
  - 检查速度（个/秒）
  - 预计剩余时间

**单个检查**
- 点击书签旁的 `🔄` 按钮
- 或右键点击书签 → `检查更新`

### 3. 管理书签

#### 右键菜单（增强版）
在书签上右键点击，可以：
- 🔄 **检查更新**: 立即检查该UP主
- 🌐 **在浏览器中打开**: 访问UP主页面
- ✏️ **编辑名称**: 修改显示名称
- 📋 **复制链接**: 复制到剪贴板
- 🗑️ **删除**: 删除该书签

#### 书签工具栏
- **添加**: 添加新的UP主
- **导入**: 从HTML文件批量导入
- **检查**: 逐个检查该UP主的更新

### 4. 查看更新

#### 更新列表
- 显示最新的视频更新
- 包含缩略图、标题、时间
- 点击标题或缩略图打开视频

#### 更新工具栏
- 🔄 **立即检查**: 检查所有书签
- ⚙ **设置**: 打开设置对话框
- 📊 **统计**: 查看统计信息
- 🗑️ **清空结果**: 清空当前显示

### 5. 设置选项

打开设置（`⚙` 按钮或 `Ctrl+,`）：

#### 检查间隔
- 范围: 1-24小时
- 推荐: 2-4小时
- 过于频繁可能触发反爬机制

#### 更新范围
- 支持: 天、月、年
- 天: 1-999天
- 月: 1-120月
- 年: 1-10年
- 示例: 设置30天表示只显示30天内的更新

#### 浏览器路径
- 可选设置
- 指定打开视频的浏览器
- 留空则使用系统默认浏览器

#### 自动检查
- 启用后自动按间隔检查
- 禁用后仅手动检查

## ⌨️ 快捷键大全

### 主要操作
| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `F5` | 刷新检查 | 检查所有书签更新 |
| `Ctrl+R` | 刷新检查 | 同上 |
| `Ctrl+N` | 添加书签 | 打开添加对话框 |
| `Ctrl+I` | 导入书签 | 打开导入对话框 |
| `Ctrl+,` | 打开设置 | 配置选项 |
| `Ctrl+K` | 清空结果 | 清空更新列表 |
| `Ctrl+Q` | 退出程序 | 关闭应用 |

### 高级操作
| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Ctrl+Shift+C` | 清理缓存 | 删除所有图片缓存 |

## 📊 统计信息

点击 `📊 统计` 按钮查看：

- **📚 书签数量**: 当前管理的UP主总数
- **🎬 视频记录**: 数据库中的视频记录
- **🕐 最后检查**: 最近一次检查的时间
- **💾 缓存大小**: 图片缓存占用空间
- **⌨️ 快捷键**: 完整的快捷键列表

## 💾 缓存管理

### 什么是缓存？
程序会将下载的UP主头像和视频缩略图保存在本地，下次加载时直接使用，节省流量和时间。

### 何时清理缓存？
- 缓存占用空间过大（如超过500MB）
- UP主更换了头像但显示旧头像
- 图片显示异常
- 定期维护（建议每月一次）

### 如何清理？
1. 按 `Ctrl+Shift+C`
2. 或点击菜单中的清理缓存选项
3. 确认后清理完成

### 缓存位置
```
cache/images/
```

## 🎨 UI特色

### 现代化设计
- **深色主题**: 护眼的深色背景
- **渐变色**: 蓝色渐变配色
- **圆角设计**: 12px大圆角
- **阴影效果**: 悬停时有轻微阴影

### 交互反馈
- **按钮动画**: 悬停上移，按下下移
- **渐变滚动条**: 蓝色渐变，12px宽
- **进度条动画**: 多彩渐变进度
- **输入框焦点**: 聚焦时蓝色发光

## 🚀 性能提升

### 检查速度
- **优化前**: 10个书签约20秒
- **优化后**: 10个书签约5秒
- **提升**: 4倍速度

### 图片加载
- **优化前**: 每次重新下载
- **优化后**: 使用本地缓存
- **提升**: 10倍以上

### 数据库查询
- **优化前**: 频繁重复查询
- **优化后**: 智能缓存
- **提升**: 减少60%查询

## 🔧 高级配置

### 调整并发数量
编辑 `ui/qt_main_window.py`:
```python
# 第264行附近
self.update_checker = UpdateChecker(session, max_workers=5)
# 将5改为其他数字，如3（更保守）或10（更激进）
```

### 调整缓存过期时间
编辑 `config/settings.py`:
```python
# 第30行
MAX_CACHE_AGE = 86400  # 24小时，可改为其他值（秒）
```

### 调整请求间隔
编辑 `config/anti_ban_config.py`:
```python
# 第10-11行
MIN_INTERVAL = 2  # 最小间隔（秒）
MAX_INTERVAL = 15  # 最大间隔（秒）
```

## ❓ 常见问题

### Q1: 检查速度还是很慢？
**A**: 
1. 检查网络连接
2. 考虑使用代理（编辑 `config/anti_ban_config.py`）
3. 减少并发数量（从5改为3）
4. 增加请求间隔

### Q2: 图片不显示？
**A**:
1. 检查网络连接
2. 清理缓存（`Ctrl+Shift+C`）
3. 检查 `cache/images` 目录权限
4. 查看日志文件 `logs/app.log`

### Q3: 遇到Cloudflare验证？
**A**:
1. 使用付费代理服务（推荐）
2. 降低请求频率
3. 更换代理IP
4. 查看 `README_反爬优化.md`

### Q4: 程序崩溃或卡死？
**A**:
1. 查看 `logs/app.log` 错误日志
2. 确保Python版本 >= 3.8
3. 重新安装依赖
4. 删除 `database.sqlite` 重新开始

### Q5: 如何备份数据？
**A**:
1. 备份 `database.sqlite` 文件
2. 或使用导出功能（未来版本）

## 📁 目录结构

```
check update/
├── main.py                 # 主程序入口
├── requirements.txt        # 依赖列表
├── database.sqlite         # 数据库文件
├── config/                 # 配置文件
│   ├── settings.py         # 基础配置
│   └── anti_ban_config.py  # 反爬配置
├── models/                 # 数据模型
│   └── database.py         # 数据库模型
├── services/               # 核心服务
│   ├── update_checker.py   # 更新检查器
│   └── web_scraper.py      # 网页爬虫
├── ui/                     # 用户界面
│   ├── qt_main_window.py   # 主窗口
│   └── style.qss           # 样式表
├── utils/                  # 工具类
│   └── image_cache.py      # 图片缓存
├── cache/                  # 缓存目录
│   └── images/             # 图片缓存
└── logs/                   # 日志目录
    └── app.log             # 应用日志
```

## 🔄 更新日志

详见 `CHANGELOG_优化版.md`

## 📝 开发计划

- [ ] WebSocket实时推送
- [ ] 系统托盘通知
- [ ] 明暗主题切换
- [ ] 导出书签和历史
- [ ] 搜索和过滤功能
- [ ] 视频预览功能
- [ ] 批量操作
- [ ] 移动端支持

## 📄 许可证

与原项目保持一致

## 🤝 贡献

欢迎提交问题和改进建议！

---

**版本**: 2.0 优化版  
**最后更新**: 2025年11月  
**技术支持**: 查看 `logs/app.log` 日志文件




